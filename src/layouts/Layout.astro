---
import Sidebar from '../components/Sidebar.astro';
import SubstackEmbed from '../components/SubstackEmbed.astro';
import LikeButton from '../components/LikeButton.astro';
import { shouldShowSubstack } from '../utils/pageUtils';
import '../styles/main.css';

interface Props {
  title: string;
}

const { title, description = "Open Design Documentation" } = Astro.props;
const path = Astro.url.pathname;

// Determine if we should show the Substack embed
const showSubstack = shouldShowSubstack(path);

// Debug info that will show on the page
const debugInfo = {
  currentPath: path,
  shouldShowSubstack: showSubstack
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Open Design Docs" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title} - Open Design Docs</title>
  </head>
  <body>
    <div class="flex min-h-screen">
      <Sidebar currentPath={path} />
      
      <main class="flex-1 lg:pl-[250px]">
        <div class="pt-20 lg:pt-20">
          <div class="max-w-[900px] mx-auto px-4 sm:px-0">
            <div class="relative">
              <div class="absolute top-0 right-0">
                <LikeButton pagePath={Astro.url.pathname} />
              </div>
              <slot />
            </div>
            {showSubstack && (
              <div class="mt-12">
                <SubstackEmbed />
              </div>
            )}
          </div>
        </div>
      </main>
    </div>

    <div 
      id="mobile-overlay"
      class="fixed inset-0 bg-black/20 backdrop-blur-sm z-40 hidden lg:hidden"
      onclick="document.getElementById('sidebar').classList.remove('translate-x-0');document.getElementById('mobile-overlay').classList.add('hidden');document.body.classList.remove('overflow-hidden');"
    ></div>
  </body>
</html>